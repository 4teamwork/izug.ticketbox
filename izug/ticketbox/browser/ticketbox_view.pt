
    <div i18n:domain="izug.ticketbox"
		tal:define="TicketQueryString python:'%s?' %
      (context.absolute_url(),);">

      <div class="documentDescription" tal:content="here/Description" />

      <div class="formControls">
        <table>
          <tr>
            <td>
              <form action="createObject"
                    id="ticketbox-submit-new-ticket-form"
                    tal:condition="python: user.has_permission('Poi: Add Issue', here)">
                <input name="type_name"
                       type="hidden"
                       value="Ticket"
                       />
                <div class="formControls">
                  <input class="context"
                         type="submit"
                         i18n:attributes="value"
						 value="Submit new issue"
                         />
                </div>
              </form>
            </td>
          </tr>
        </table>
      </div>

      <div id="tickets-by-responsible" class="ticketbox-quick-search-box">
          <h3 i18n:translate="ticketbox_heading_by_responsible">By responsible</h3>
          <ul>
              <tal:areas repeat="responsible here/get_assignable_users">
                <li tal:define="responsibleId python:responsible[0];
								responsibleTitle python:responsible[1];
								tickets python:view.getFilteredTickets(responsible=responsibleId)
								">
                <a tal:attributes="href string:${context/absolute_url}?searchkey=responsible&searchvalue=${responsibleId}"
                   tal:content="responsibleTitle" /> (<span tal:replace="python:len(tickets)" />)
               </li>
              </tal:areas>
          </ul>
      </div>


      <div id="tickets-by-state" class="ticketbox-quick-search-box">
          <h3 i18n:translate="ticketbox_heading_by_states">By states</h3>
          <ul>
              <tal:areas repeat="states here/getAvailableStates">
                <li tal:define="stateId states/id;
								stateTitle states/title;
								tickets python:view.getFilteredTickets(state=stateId)
								">
                <a tal:attributes="href string:${context/absolute_url}?searchkey=state&searchvalue=${stateId}"
                   tal:content="stateTitle" /> (<span tal:replace="python:len(tickets)" />)
               </li>
              </tal:areas>
          </ul>
      </div>


      <div id="tickets-by-release" class="ticketbox-quick-search-box">
          <h3 i18n:translate="ticketbox_heading_by_release">By release</h3>
          <ul>
              <tal:areas repeat="release here/getAvailableReleases">
                <li tal:define="releaseId release/id;
								releaseTitle release/title;
								tickets python:view.getFilteredTickets(release=releaseId)
								">
                <a tal:attributes="href string:${context/absolute_url}?searchkey=release&searchvalue=${releaseId}"
                   tal:content="releaseTitle" /> (<span tal:replace="python:len(tickets)" />)
               </li>
              </tal:areas>
          </ul>
      </div>


      <div id="tickets-by-area" class="ticketbox-quick-search-box">
          <h3 i18n:translate="ticketbox_heading_by_area">By area</h3>
          <ul>
              <tal:areas repeat="area here/getAvailableAreas">
                <li tal:define="areaId area/id;
								areaTitle area/title;
								tickets python:view.getFilteredTickets(area=areaId)
								">
                <a tal:attributes="href string:${context/absolute_url}?searchkey=area&searchvalue=${areaId}"
                   tal:content="areaTitle" /> (<span tal:replace="python:len(tickets)" />)
               </li>
              </tal:areas>
          </ul>
      </div>


      <div id="tickets-by-priority" class="ticketbox-quick-search-box">
          <h3 i18n:translate="ticketbox_heading_by_severities">By priority</h3>
          <ul>
              <tal:areas repeat="priority here/getAvailablePriorities">
                <li tal:define="priorityId priority/id;
								priorityTitle priority/title;
								tickets python:view.getFilteredTickets(priority=priorityId)

								">
                <a tal:attributes="href string:${context/absolute_url}?searchkey=priority&searchvalue=${priorityId}"
                   tal:content="priorityTitle" /> (<span tal:replace="python:len(tickets)" />)
               </li>
              </tal:areas>
          </ul>
      </div>


      <div class="visualClear"><!----></div>


	<tal:translation>
	  <form name="tabbedview_form"
	        method="post"
	        action="folder_object"
	        tal:attributes="action context/absolute_url"
	        tal:define="Batch python:modules['Products.CMFPlone'].Batch;
	        			b_size python:50;
	        			b_size request/b_size | b_size;
	        			b_size python: type(b_size) == type([]) and b_size[-1] or b_size;
	        			b_start python:0;b_start request/b_start | b_start;
	        			b_range python: b_start==0 and 5 or 3;
	        			batch python:Batch(view.contents, int(b_size), int(b_start), orphan=1,pagerange=int(b_range));"
	        >

	    <input type="hidden" name="orig_template" tal:attributes="value string:${here/absolute_url}/#${view/view_name}" />

	    <tal:cond tal:condition="view/contents">
	        <div metal:use-macro="here/batch_macros_search/macros/navigation" tal:condition="request/show" />
	        <div tal:content="structure view/render_listing" />
	    </tal:cond>

	    <p tal:condition="not: view/contents">
	        Keine Inhalte vorhanden
	    </p>

	  </form>

	<script type="text/javascript">
		jq(function(){
			var $links = jq('.ticketbox-quick-search-box a');
			$links.bind('click', function(e){
			  e.preventDefault();
			  $this = jq(this);
			  params =jq.find_param($this.attr('href'));
			  params_searchvalue = params['searchvalue']
			  params_searchkey = params['searchkey']
			  tabbedview.add_param(params_searchkey, params_searchvalue);
			  tabbedview.reload_view();
			  <!-- jq('.sortable-table').show() -->
			  tabbedview.delete_param(params_searchkey, params_searchvalue);
			});

		});

	</script>

	</tal:translation>


    </div>




